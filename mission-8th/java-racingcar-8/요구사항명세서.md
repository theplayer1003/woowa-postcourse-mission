# 요구사항 명세서
---

# java-racingcar-8

# 비즈니스 불변식

-[ ] 자동차, `Car`
    -[ ] 자동차는 전진할 수 있다
        -[ ] 전진 여부는 무작위 숫자 생성으로 판단한다
    -[ ] 자동차는 후진할 수 없다
    -[ ] 자동차는 이름을 가진다
        -[ ] 자동차 이름은 5자 이하만 가능하다
        -[ ] 자동차 이름은 공백을 허용하지 않는다
    -[ ] 자동차는 위치를 가진다
        - [ ] 위치는 정수값이며 음수가 될 수 없다
-[ ] 라운드 수, `Round`
    - [ ] 입력 받은 라운드 수만큼 move를 수행한다
    - [ ] 라운드 수는 1 이상이어야 한다
    - [ ] 한 라운드가 진행되고 결과를 출력한다
-[ ] 숫자 생성기, `WoowaNumberGenerator`
    -[ ] 0-9 사이의 무작위 숫자를 생성해 4 이상일 경우 움직인다
-[ ] 최종 결과, `FinalResult`
    -[ ] 라운드가 모두 수행되고 우승자 이름(들)을 출력할 수 있어야 한다
    - [ ] 점수가 같다면 공동 우승자가 된다

# 도메인 모델

## 도메인 클래스 정리

`Car`

- 책임: 자신의 위치 정보를 관리하고, 전략에 따라 이동한다
- 상태
    - `CarName`: 자동차 이름, VO
    - `Position`: 위치 정보, VO
- 메서드
    - `move(MovingStrategy)`: 전략의 `isMovable()` 이 참이면 `Position` 값이 증가

`Cars`

- 책임: `Car` 들의 생명주기를 관리하고 순회하며 메시지를 전달한다
- 상태
    - `List<Car>`: 만들어진 자동차 목록
- 메서드
    - `playOneRound(MovingStrategy)`: `Car` 들에게 `move` 메시지 전송
    - `findWinners()`: `Position` 이 가장 높은 `Car` 를 찾아 `FinalResult`로 반환

`Round`

- 책임: 라운드 수를 가지며 라운드 진행 가능 여부를 판단한다
- 상태
    - `int`: 남은 진행 횟수
- 메서드
    - `isNotFinised()`: 남은 회수를 검사해서 진행 가능 여부를 판단
    - `next()`: 남은 회수를 1회 차감

`CarFactory`

- 책임: `Car` 를 생성하기 위해 사용자 입력을 파싱한다
- 상태
    - `delimiter`: 자동차 이름을 파싱하기 위한 구분자 정보
- 메서드
    - `getCars`: 파싱을 진행하고 `Cars`를 생성해서 반환

`DtoMaker`

- 책임: 도메인 결과를 알맞은 DTO로 변환한다

## 도메인 시나리오

- `Presentation` 계층으로부터 자동차 이름을(`CarNamesUserInput`) 전달 받는다
    - `Service` 객체가 `CarFactory` 에게 `CarNamesUserInput` 을 주며 `Cars` 생성을 요청한다
        - `CarFactory` 는 `CarNamesUserInput` 를 분리하고 `Car` 들을 생성해 `Cars` 를 생성 후 반환한다


- `Presentation` 계층으로부터 시도할 횟수를 입력 받는다
    - `Service` 객체가 `Round` 를 생성한다
    - `Service` 객체가 `Round.isNotFinished()` 로 로직을 반복 수행한다
        - `Cars` 는 `Car` 를 이동시키고, 현재 상태를 반환한다
        - `Service` 객체는 현재 상태를 `EventBus` 를 통해 발행한다
        - `Service` 는 `Round.next()` 를 호출해 시도 횟수를 차감한다


- `Presentation` 계층으로부터 최종 결과 반환을 요청 받는다
    - `Service` 객체가 `Cars` 에게 `FinalResult` 생성을 요청한다
    - `Service` 객체가 `DtoMaker` 에게 `FinalResult` 를 전달해 `FinalResultDto` 생성을 요청한다